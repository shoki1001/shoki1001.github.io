<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r127/three.min.js"></script>
    <script>
      // ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã‚’å¾…ã¤
      window.addEventListener('load', init);

      function init() {
        // ã‚µã‚¤ã‚ºã‚’æŒ‡å®š
        const width = 960;
        const height = 540;

        // ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã‚’ä½œæˆ
        const renderer = new THREE.WebGLRenderer({
          canvas: document.querySelector('#myCanvas'),
          antialias: true,
          devicePixelRatio: window.devicePixelRatio,
        });
        renderer.setSize(width, height);

        // ã‚·ãƒ¼ãƒ³ã‚’ä½œæˆ
        const scene = new THREE.Scene();

        // ãƒ•ã‚©ã‚°ã‚’è¨­å®š
        scene.fog = new THREE.Fog(0x00ffff, 50, 2000);


        // ã‚«ãƒ¡ãƒ©ã‚’ä½œæˆ
        const camera = new THREE.PerspectiveCamera(45, width / height);
        camera.position.set(0, 0, +1000);

        // ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆ
        const group = new THREE.Group();
        scene.add(group);
        const geometry = new THREE.SphereBufferGeometry(50, 50, 50);
        const material = new THREE.MeshStandardMaterial({color: 0xA63744, roughness:1.5});

        for (let i = 0; i < 1100; i++) {
          const mesh = new THREE.Mesh(geometry, material);
          mesh.position.x = (Math.random() - 0.5) * 2000;
          mesh.position.y = (Math.random() - 0.5) * 2000;
          mesh.position.z = (Math.random() - 0.5) * 2000;
          mesh.rotation.x = Math.random() * 2 * Math.PI;
          mesh.rotation.y = Math.random() * 2 * Math.PI;
          mesh.rotation.z = Math.random() * 2 * Math.PI;
          // çƒä½“ã®ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã‚’å–å¾—ã™ã‚‹
          const worldPosition = mesh.getWorldPosition(new THREE.Vector3());
          // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³åº§æ¨™ã‚’å–å¾—ã™ã‚‹
          const projection = worldPosition.project(camera);
          const sx = (width / 2) * (+projection.x + 1.0);
          const sy = (height / 2) * (-projection.y + 1.0);

          const tf = document.getElementById('hud');
          // ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³åº§æ¨™ã‚’è¡¨ç¤º
          tf.innerHTML = `ğŸ‘†ã‚¹ã‚¯ãƒªãƒ¼ãƒ³åº§æ¨™(${Math.round(sx)}, ${Math.round(sy)})`;
          tf.style.transform = `translate(${sx}px, ${sy}px)`;

        
          // ã‚°ãƒ«ãƒ¼ãƒ—ã«æ ¼ç´ã™ã‚‹
          group.add(mesh);
        }
        

        // å…‰æº
        scene.add(new THREE.DirectionalLight(0xff0000, 2)); // å¹³è¡Œå…‰æº
        scene.add(new THREE.AmbientLight(0xA63744)); // ç’°å¢ƒå…‰æº

        // æ¯ãƒ•ãƒ¬ãƒ¼ãƒ æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒ«ãƒ¼ãƒ—ã‚¤ãƒ™ãƒ³ãƒˆã§ã™
        tick();

        function tick() {
          // ã‚°ãƒ«ãƒ¼ãƒ—ã‚’å›ã™
          group.rotateX(0.01);
          renderer.render(scene, camera); // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
          requestAnimationFrame(tick);
        }
      }
    </script>
  </head>
  <body>
    <canvas id="myCanvas"></canvas>
  </body>
</html>